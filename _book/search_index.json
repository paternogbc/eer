[
["index.html", "Ecologia Ecolutiva em R 1 Sobre o livro", " Ecologia Ecolutiva em R Gustavo Brant Paterno 2016-07-23 1 Sobre o livro Este livro é um projeto aberto e livre. "],
["pacotes.html", "2 Pacotes necessários", " 2 Pacotes necessários Para rodar todos os exemplos do livro é necessário instalar estes pacotes: install.packages(&quot;ape&quot;) install.packages(&quot;phytools&quot;) install.packages(&quot;picante&quot;) install.packages(&quot;caper&quot;) install.packages(&quot;phylolm&quot;) install.packages(&quot;sensiPhy&quot;) "],
["arvores-filogneticas.html", "3 Árvores filognéticas 3.1 Como carregar um árvore filogenética no R? 3.2 Como visualizar a árvore 3.3 Características da sua árvore 3.4 Existem politomias na minha árvore? 3.5 Como remover uma/várias espécies da árvore? 3.6 Exporte sua arvore 3.7 Como criar um árvore filogenética manualmente?", " 3 Árvores filognéticas Pacotes necessários neste capítulo: library(ape) 3.1 Como carregar um árvore filogenética no R? A função read.tree() pode ser utilizada para ler árvores no formato Newick. Utilize o argumento file para indicar o local do arquivo. No exemplo abaixo, o arquivo arvore.tre está dentro da pasta filogenia. arvore &lt;- read.tree(file = &quot;filogenia/arvore.tre&quot;) Confira se a árvore foi carregada corretamente (número de espécies, número de nós, nome das espécies, se a árvore é enraizada e se possui informações sobre o comprimento dos ramos) arvore ## ## Phylogenetic tree with 71 tips and 62 internal nodes. ## ## Tip labels: ## Catoptrophorus_semipalmatus, Tringa_ochropus, Tringa_stagnatilis, Tringa_flavipes, Tringa_nebularia, Tringa_totanus, ... ## ## Rooted; includes branch lengths. 3.2 Como visualizar a árvore plot(arvore, cex = .5) # cex regula o tamanho da fonte plot(arvore, show.tip.label = F) # esconde os nomes as espécies plot(arvore, type = &quot;fan&quot;, cex = .5) # Plota uma árvore circular 3.3 Características da sua árvore # Veja a lista de espécies da sua árvore: arvore$tip.label ## [1] &quot;Catoptrophorus_semipalmatus&quot; &quot;Tringa_ochropus&quot; ## [3] &quot;Tringa_stagnatilis&quot; &quot;Tringa_flavipes&quot; ## [5] &quot;Tringa_nebularia&quot; &quot;Tringa_totanus&quot; ## [7] &quot;Tringa_erythropus&quot; &quot;Tringa_melanoleuca&quot; ## [9] &quot;Tringa_glareola&quot; &quot;Steganopus_tricolor&quot; ## [11] &quot;Phalaropus_lobatus&quot; &quot;Phalaropus_fulicaria&quot; ## [13] &quot;Micropalama_himantopus&quot; &quot;Eurynorhynchus_pygmeus&quot; ## [15] &quot;Aphriza_virgata&quot; &quot;Calidris_canutus&quot; ## [17] &quot;Calidris_tenuirostris&quot; &quot;Calidris_temminckii&quot; ## [19] &quot;Calidris_maritima&quot; &quot;Calidris_ptilocnemis&quot; ## [21] &quot;Calidris_mauri&quot; &quot;Calidris_alba&quot; ## [23] &quot;Calidris_alpina&quot; &quot;Calidris_bairdii&quot; ## [25] &quot;Calidris_minutilla&quot; &quot;Calidris_pusilla&quot; ## [27] &quot;Calidris_minuta&quot; &quot;Calidris_ruficollis&quot; ## [29] &quot;Calidris_subminuta&quot; &quot;Arenaria_interpres&quot; ## [31] &quot;Arenaria_melanocephala&quot; &quot;Tringa_hypoleucos&quot; ## [33] &quot;Tringa_macularia&quot; &quot;Limnodromus_griseus&quot; ## [35] &quot;Gallinago_gallinago&quot; &quot;Coenocorypha_aucklandica&quot; ## [37] &quot;Coenocorypha_pusilla&quot; &quot;Limosa_fedoa&quot; ## [39] &quot;Limosa_haemastica&quot; &quot;Limosa_limosa&quot; ## [41] &quot;Limosa_lapponica&quot; &quot;Bartramia_longicauda&quot; ## [43] &quot;Numenius_tahitiensis&quot; &quot;Numenius_phaeopus&quot; ## [45] &quot;Numenius_arquata&quot; &quot;Numenius_americanus&quot; ## [47] &quot;Rostratula_benghalensis&quot; &quot;Jacana_spinosa&quot; ## [49] &quot;Jacana_jacana&quot; &quot;Metopidius_indicus&quot; ## [51] &quot;Actophilornis_africanus&quot; &quot;Pedionomus_torquatus&quot; ## [53] &quot;Pluvialis_apricaria&quot; &quot;Pluvialis_dominica&quot; ## [55] &quot;Eudromias_morinellus&quot; &quot;Charadrius_montanus&quot; ## [57] &quot;Charadrius_vociferus&quot; &quot;Charadrius_wilsonia&quot; ## [59] &quot;Charadrius_dubius&quot; &quot;Charadrius_hiaticula&quot; ## [61] &quot;Charadrius_melodus&quot; &quot;Vanellus_vanellus&quot; ## [63] &quot;Vanellus_lugubris&quot; &quot;Vanellus_armatus&quot; ## [65] &quot;Recurvirostra_avosetta&quot; &quot;Haematopus_longirostris&quot; ## [67] &quot;Haematopus_fuliginosus&quot; &quot;Haematopus_moquini&quot; ## [69] &quot;Haematopus_ostralegus&quot; &quot;Haematopus_unicolor&quot; ## [71] &quot;Haematopus_finschi&quot; # Veja o comprimento dos ramos: arvore$edge.length ## [1] 18.072 13.400 13.400 2.600 2.300 9.900 2.499 19.701 0.615 19.086 ## [11] 2.210 3.114 13.762 13.762 13.762 13.762 8.438 5.324 5.324 16.876 ## [21] 18.780 3.420 1.262 2.158 2.158 5.400 9.287 17.413 17.413 11.394 ## [31] 6.019 2.221 3.798 3.798 7.400 10.013 0.436 6.989 2.588 2.588 ## [41] 0.435 9.142 0.435 8.707 0.436 0.435 7.836 0.436 7.400 0.435 ## [51] 6.965 3.482 3.483 3.483 5.662 2.609 2.609 21.020 5.680 5.680 ## [61] 26.321 5.779 5.779 10.600 23.800 1.000 22.800 17.890 4.910 4.910 ## [71] 25.261 11.739 2.436 9.303 3.434 5.869 5.869 30.101 20.299 5.430 ## [81] 14.869 4.719 10.150 3.746 6.404 6.404 11.700 8.800 43.300 10.900 ## [91] 21.600 10.800 10.800 12.555 19.845 19.845 52.100 49.072 1.033 23.437 ## [101] 8.330 8.330 2.067 3.000 26.700 3.708 22.992 7.417 10.027 5.548 ## [111] 5.548 2.693 12.882 4.089 8.793 8.793 6.739 22.961 22.961 22.961 ## [121] 13.700 19.100 4.283 14.817 1.968 12.849 1.777 11.072 6.789 4.283 ## [131] 4.283 11.072 # Como verificar se a árvore é ultramétrica? is.ultrametric(arvore) ## [1] TRUE # Como verificar se a árvore é enraizada? is.rooted(arvore) ## [1] TRUE Se a árvore não tiver nome nos nós (nodes), utilize essa função para criar nomes para os nós arvore$node.label ## NULL arvore &lt;- makeNodeLabel(arvore) # Veja que agora os nós possuem um nome: arvore$node.label ## [1] &quot;Node1&quot; &quot;Node2&quot; &quot;Node3&quot; &quot;Node4&quot; &quot;Node5&quot; &quot;Node6&quot; &quot;Node7&quot; ## [8] &quot;Node8&quot; &quot;Node9&quot; &quot;Node10&quot; &quot;Node11&quot; &quot;Node12&quot; &quot;Node13&quot; &quot;Node14&quot; ## [15] &quot;Node15&quot; &quot;Node16&quot; &quot;Node17&quot; &quot;Node18&quot; &quot;Node19&quot; &quot;Node20&quot; &quot;Node21&quot; ## [22] &quot;Node22&quot; &quot;Node23&quot; &quot;Node24&quot; &quot;Node25&quot; &quot;Node26&quot; &quot;Node27&quot; &quot;Node28&quot; ## [29] &quot;Node29&quot; &quot;Node30&quot; &quot;Node31&quot; &quot;Node32&quot; &quot;Node33&quot; &quot;Node34&quot; &quot;Node35&quot; ## [36] &quot;Node36&quot; &quot;Node37&quot; &quot;Node38&quot; &quot;Node39&quot; &quot;Node40&quot; &quot;Node41&quot; &quot;Node42&quot; ## [43] &quot;Node43&quot; &quot;Node44&quot; &quot;Node45&quot; &quot;Node46&quot; &quot;Node47&quot; &quot;Node48&quot; &quot;Node49&quot; ## [50] &quot;Node50&quot; &quot;Node51&quot; &quot;Node52&quot; &quot;Node53&quot; &quot;Node54&quot; &quot;Node55&quot; &quot;Node56&quot; ## [57] &quot;Node57&quot; &quot;Node58&quot; &quot;Node59&quot; &quot;Node60&quot; &quot;Node61&quot; &quot;Node62&quot; 3.4 Existem politomias na minha árvore? Se a sua árvore não tiver politomias, o número de nós dever ser igual ao número de espécies -1. Se isso não ocorrer, sua árvore possue politomias: Nnode &lt;- arvore$Nnode # Número de nós Nsp &lt;- length(arvore$tip.label) # Número de espécies # Existem politomias na minha árvore? Nnode == (Nsp -1) ## [1] FALSE # Quantas politomias existem na minha árvore? (Nsp -1) - Nnode ## [1] 8 3.5 Como remover uma/várias espécies da árvore? drop.tip(arvore, arvore$tip.label[1]) # remove a primeira espécies da árvore ## ## Phylogenetic tree with 70 tips and 61 internal nodes. ## ## Tip labels: ## Tringa_ochropus, Tringa_stagnatilis, Tringa_flavipes, Tringa_nebularia, Tringa_totanus, Tringa_erythropus, ... ## Node labels: ## Node1, Node2, Node3, Node4, Node5, Node6, ... ## ## Rooted; includes branch lengths. drop.tip(arvore, arvore$tip.label[1:5]) # remove as cinco primeiras espécies ## ## Phylogenetic tree with 66 tips and 60 internal nodes. ## ## Tip labels: ## Tringa_totanus, Tringa_erythropus, Tringa_melanoleuca, Tringa_glareola, Steganopus_tricolor, Phalaropus_lobatus, ... ## Node labels: ## Node1, Node2, Node3, Node4, Node5, Node6, ... ## ## Rooted; includes branch lengths. drop.tip(arvore, &quot;Tringa_glareola&quot;) # remove a espécies &quot;Tringa_glareola&quot; ## ## Phylogenetic tree with 70 tips and 61 internal nodes. ## ## Tip labels: ## Catoptrophorus_semipalmatus, Tringa_ochropus, Tringa_stagnatilis, Tringa_flavipes, Tringa_nebularia, Tringa_totanus, ... ## Node labels: ## Node1, Node2, Node3, Node4, Node5, Node6, ... ## ## Rooted; includes branch lengths. # Como cortar um node da árvore (nó)? extract.clade(phy = arvore, node = &quot;Node61&quot;) # remove o nó 61 ## ## Phylogenetic tree with 4 tips and 2 internal nodes. ## ## Tip labels: ## [1] &quot;Haematopus_moquini&quot; &quot;Haematopus_ostralegus&quot; &quot;Haematopus_unicolor&quot; ## [4] &quot;Haematopus_finschi&quot; ## Node labels: ## [1] &quot;Node61&quot; &quot;Node62&quot; ## ## Unrooted; includes branch lengths. 3.6 Exporte sua arvore Depois de remover as espécies que deseja, você pode salvar a árvore em um novo objeto: arvore2 &lt;- drop.tip(arvore, c(&quot;Tringa_glareola&quot;, &quot;Haematopus_ostralegus&quot;)) arvore2 # perceba que agora a árvore possui 69 espécies (em vez de 71) ## ## Phylogenetic tree with 69 tips and 60 internal nodes. ## ## Tip labels: ## Catoptrophorus_semipalmatus, Tringa_ochropus, Tringa_stagnatilis, Tringa_flavipes, Tringa_nebularia, Tringa_totanus, ... ## Node labels: ## Node1, Node2, Node3, Node4, Node5, Node6, ... ## ## Rooted; includes branch lengths. Para exportar a árvore em formato Newwick, utilize a função ‘write.tree()’ write.tree(phy = arvore2, file = &quot;arvore2.tre&quot;) 3.7 Como criar um árvore filogenética manualmente? ## ## Phylogenetic tree with 3 tips and 2 internal nodes. ## ## Tip labels: ## [1] &quot;specie_A&quot; &quot;specie_B&quot; &quot;especie_C&quot; ## ## Rooted; includes branch lengths. "],
["methods.html", "4 Methods", " 4 Methods We describe our methods in this chapter. "],
["applications.html", "5 Applications 5.1 Example one 5.2 Example two", " 5 Applications Some significant applications are demonstrated in this chapter. 5.1 Example one 5.2 Example two "],
["final-words.html", "6 Final Words", " 6 Final Words We have finished a nice book. "],
["references.html", "References", " References "]
]
